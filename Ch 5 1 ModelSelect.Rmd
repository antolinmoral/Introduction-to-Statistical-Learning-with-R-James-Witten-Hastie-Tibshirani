---
title: "Ch 5 1 ModelSelect"
output: pdf_document
---


```{r}
library(ISLR)
summary(Hitters)
```

There are missing values, before we proceed we will remove them:

```{r}
with(Hitters, sum(is.na(Salary)))
Hitters=na.omit(Hitters)
with(Hitters, sum(is.na(Salary)))
```

Best Subset regression
----------------------
We will now use the package `leaps` to evaluate all the best-subset models.
```{r}
library(leaps)
regfit.full = regsubsets(Salary~., data=Hitters)
summary(regfit.full)
```

By default, it gives the first 8 variables best-subset models. Let's do it again for all
the variables:

```{r}
regfit.full = regsubsets(Salary~., data=Hitters, nvmax=19)
reg.summary = summary(regfit.full)
names(reg.summary)
plot(reg.summary$cp, xlab="Number of variables", ylab="Cp")
which.min(reg.summary$cp)
points(10, reg.summary$cp[10], pch=20, col="red")
```

There is a method for the `regsubset` object:

```{r}
plot(regfit.full,scale="Cp")
coef(regfit.full, 10)
```


